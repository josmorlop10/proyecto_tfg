                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module Common
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _wait_vbl_done
                                     11 	.globl _performantdelay
                                     12 	.globl _tileindex_from_xy
                                     13 ;--------------------------------------------------------
                                     14 ; special function registers
                                     15 ;--------------------------------------------------------
                                     16 ;--------------------------------------------------------
                                     17 ; ram data
                                     18 ;--------------------------------------------------------
                                     19 	.area _DATA
                                     20 ;--------------------------------------------------------
                                     21 ; ram data
                                     22 ;--------------------------------------------------------
                                     23 	.area _INITIALIZED
                                     24 ;--------------------------------------------------------
                                     25 ; absolute external ram data
                                     26 ;--------------------------------------------------------
                                     27 	.area _DABS (ABS)
                                     28 ;--------------------------------------------------------
                                     29 ; global & static initialisations
                                     30 ;--------------------------------------------------------
                                     31 	.area _HOME
                                     32 	.area _GSINIT
                                     33 	.area _GSFINAL
                                     34 	.area _GSINIT
                                     35 ;--------------------------------------------------------
                                     36 ; Home
                                     37 ;--------------------------------------------------------
                                     38 	.area _HOME
                                     39 	.area _HOME
                                     40 ;--------------------------------------------------------
                                     41 ; code
                                     42 ;--------------------------------------------------------
                                     43 	.area _CODE
                                     44 ;src/Common.c:5: void performantdelay(uint8_t numloops){
                                     45 ;	---------------------------------
                                     46 ; Function performantdelay
                                     47 ; ---------------------------------
    00000000                         48 _performantdelay::
    00000000 4F               [ 4]   49 	ld	c, a
                                     50 ;src/Common.c:7: for(i = 0; i < numloops; i++){
    00000001 06 00            [ 8]   51 	ld	b, #0x00
    00000003                         52 00103$:
    00000003 78               [ 4]   53 	ld	a, b
    00000004 91               [ 4]   54 	sub	a, c
    00000005 D0               [20]   55 	ret	NC
                                     56 ;src/Common.c:8: wait_vbl_done();
    00000006 CDr00r00         [24]   57 	call	_wait_vbl_done
                                     58 ;src/Common.c:7: for(i = 0; i < numloops; i++){
    00000009 04               [ 4]   59 	inc	b
                                     60 ;src/Common.c:10: }
    0000000A 18 F7            [12]   61 	jr	00103$
                                     62 ;src/Common.c:12: uint16_t tileindex_from_xy(uint8_t x, uint8_t y){
                                     63 ;	---------------------------------
                                     64 ; Function tileindex_from_xy
                                     65 ; ---------------------------------
    0000000C                         66 _tileindex_from_xy::
    0000000C E8 FA            [16]   67 	add	sp, #-6
    0000000E F8 05            [12]   68 	ldhl	sp,	#5
    00000010 73               [ 8]   69 	ld	(hl), e
                                     70 ;src/Common.c:21: uint8_t indexBRx = (x - 8) / 8; //señala la columna
    00000011 F8 01            [12]   71 	ldhl	sp,	#1
    00000013 22               [ 8]   72 	ld	(hl+), a
    00000014 AF               [ 4]   73 	xor	a, a
    00000015 32               [ 8]   74 	ld	(hl-), a
    00000016 2A               [ 8]   75 	ld	a, (hl+)
    00000017 5F               [ 4]   76 	ld	e, a
    00000018 56               [ 8]   77 	ld	d, (hl)
    00000019 21 08 00         [12]   78 	ld	hl, #0x0008
    0000001C 7B               [ 4]   79 	ld	a, e
    0000001D 95               [ 4]   80 	sub	a, l
    0000001E 5F               [ 4]   81 	ld	e, a
    0000001F 7A               [ 4]   82 	ld	a, d
    00000020 9C               [ 4]   83 	sbc	a, h
    00000021 F8 04            [12]   84 	ldhl	sp,	#4
    00000023 32               [ 8]   85 	ld	(hl-), a
    00000024 73               [ 8]   86 	ld	(hl), e
    00000025 2A               [ 8]   87 	ld	a, (hl+)
    00000026 4F               [ 4]   88 	ld	c, a
    00000027 46               [ 8]   89 	ld	b, (hl)
    00000028 CB 7E            [12]   90 	bit	7, (hl)
    0000002A 28 0C            [12]   91 	jr	Z, 00103$
    0000002C 2B               [ 8]   92 	dec	hl
    0000002D 2B               [ 8]   93 	dec	hl
    0000002E 2B               [ 8]   94 	dec	hl
    0000002F 2A               [ 8]   95 	ld	a, (hl+)
    00000030 5F               [ 4]   96 	ld	e, a
    00000031 56               [ 8]   97 	ld	d, (hl)
    00000032 21 FF FF         [12]   98 	ld	hl, #0xffff
    00000035 19               [ 8]   99 	add	hl, de
    00000036 4D               [ 4]  100 	ld	c, l
    00000037 44               [ 4]  101 	ld	b, h
    00000038                        102 00103$:
    00000038 CB 28            [ 8]  103 	sra	b
    0000003A CB 19            [ 8]  104 	rr	c
    0000003C CB 28            [ 8]  105 	sra	b
    0000003E CB 19            [ 8]  106 	rr	c
    00000040 CB 28            [ 8]  107 	sra	b
    00000042 CB 19            [ 8]  108 	rr	c
    00000044 F8 00            [12]  109 	ldhl	sp,	#0
    00000046 71               [ 8]  110 	ld	(hl), c
                                    111 ;src/Common.c:22: uint8_t indexBRy = (y - 16) / 8; //señala la fila
    00000047 F8 05            [12]  112 	ldhl	sp,	#5
    00000049 7E               [ 8]  113 	ld	a, (hl)
    0000004A F8 01            [12]  114 	ldhl	sp,	#1
    0000004C 22               [ 8]  115 	ld	(hl+), a
    0000004D AF               [ 4]  116 	xor	a, a
    0000004E 32               [ 8]  117 	ld	(hl-), a
    0000004F 2A               [ 8]  118 	ld	a, (hl+)
    00000050 5F               [ 4]  119 	ld	e, a
    00000051 56               [ 8]  120 	ld	d, (hl)
    00000052 21 10 00         [12]  121 	ld	hl, #0x0010
    00000055 7B               [ 4]  122 	ld	a, e
    00000056 95               [ 4]  123 	sub	a, l
    00000057 5F               [ 4]  124 	ld	e, a
    00000058 7A               [ 4]  125 	ld	a, d
    00000059 9C               [ 4]  126 	sbc	a, h
    0000005A F8 04            [12]  127 	ldhl	sp,	#4
    0000005C 32               [ 8]  128 	ld	(hl-), a
    0000005D 73               [ 8]  129 	ld	(hl), e
    0000005E 2A               [ 8]  130 	ld	a, (hl+)
    0000005F 4F               [ 4]  131 	ld	c, a
    00000060 46               [ 8]  132 	ld	b, (hl)
    00000061 CB 7E            [12]  133 	bit	7, (hl)
    00000063 28 0C            [12]  134 	jr	Z, 00104$
    00000065 2B               [ 8]  135 	dec	hl
    00000066 2B               [ 8]  136 	dec	hl
    00000067 2B               [ 8]  137 	dec	hl
    00000068 2A               [ 8]  138 	ld	a, (hl+)
    00000069 5F               [ 4]  139 	ld	e, a
    0000006A 56               [ 8]  140 	ld	d, (hl)
    0000006B 21 F7 FF         [12]  141 	ld	hl, #0xfff7
    0000006E 19               [ 8]  142 	add	hl, de
    0000006F 4D               [ 4]  143 	ld	c, l
    00000070 44               [ 4]  144 	ld	b, h
    00000071                        145 00104$:
    00000071 CB 28            [ 8]  146 	sra	b
    00000073 CB 19            [ 8]  147 	rr	c
    00000075 CB 28            [ 8]  148 	sra	b
    00000077 CB 19            [ 8]  149 	rr	c
    00000079 CB 28            [ 8]  150 	sra	b
    0000007B CB 19            [ 8]  151 	rr	c
                                    152 ;src/Common.c:23: uint16_t tileindexBR = 20 * indexBRy + indexBRx;
    0000007D 06 00            [ 8]  153 	ld	b, #0x00
    0000007F 69               [ 4]  154 	ld	l, c
    00000080 60               [ 4]  155 	ld	h, b
    00000081 29               [ 8]  156 	add	hl, hl
    00000082 29               [ 8]  157 	add	hl, hl
    00000083 09               [ 8]  158 	add	hl, bc
    00000084 29               [ 8]  159 	add	hl, hl
    00000085 29               [ 8]  160 	add	hl, hl
    00000086 4D               [ 4]  161 	ld	c, l
    00000087 44               [ 4]  162 	ld	b, h
    00000088 F8 00            [12]  163 	ldhl	sp,	#0
    0000008A 7E               [ 8]  164 	ld	a, (hl)
    0000008B 1E 00            [ 8]  165 	ld	e, #0x00
    0000008D 81               [ 4]  166 	add	a, c
    0000008E 4F               [ 4]  167 	ld	c, a
    0000008F 7B               [ 4]  168 	ld	a, e
    00000090 88               [ 4]  169 	adc	a, b
    00000091 47               [ 4]  170 	ld	b, a
                                    171 ;src/Common.c:25: return tileindexBR;
                                    172 ;src/Common.c:26: }
    00000092 E8 06            [16]  173 	add	sp, #6
    00000094 C9               [16]  174 	ret
                                    175 	.area _CODE
                                    176 	.area _INITIALIZER
                                    177 	.area _CABS (ABS)
