                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module main
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _main
                                     11 	.globl _init_gfx
                                     12 	.globl _update_game_state
                                     13 	.globl _update_character
                                     14 	.globl _character_init
                                     15 	.globl _get_colision_from_map
                                     16 	.globl _performantdelay
                                     17 	.globl _printf
                                     18 	.globl _set_sprite_data
                                     19 	.globl _set_bkg_tiles
                                     20 	.globl _set_bkg_data
                                     21 	.globl _joypad
                                     22 	.globl _last_state
                                     23 	.globl _p
                                     24 ;--------------------------------------------------------
                                     25 ; special function registers
                                     26 ;--------------------------------------------------------
                                     27 ;--------------------------------------------------------
                                     28 ; ram data
                                     29 ;--------------------------------------------------------
                                     30 	.area _DATA
    00000000                         31 _p::
    00000000                         32 	.ds 9
    00000009                         33 _last_state::
    00000009                         34 	.ds 1
                                     35 ;--------------------------------------------------------
                                     36 ; ram data
                                     37 ;--------------------------------------------------------
                                     38 	.area _INITIALIZED
                                     39 ;--------------------------------------------------------
                                     40 ; absolute external ram data
                                     41 ;--------------------------------------------------------
                                     42 	.area _DABS (ABS)
                                     43 ;--------------------------------------------------------
                                     44 ; global & static initialisations
                                     45 ;--------------------------------------------------------
                                     46 	.area _HOME
                                     47 	.area _GSINIT
                                     48 	.area _GSFINAL
                                     49 	.area _GSINIT
                                     50 ;--------------------------------------------------------
                                     51 ; Home
                                     52 ;--------------------------------------------------------
                                     53 	.area _HOME
                                     54 	.area _HOME
                                     55 ;--------------------------------------------------------
                                     56 ; code
                                     57 ;--------------------------------------------------------
                                     58 	.area _CODE
                                     59 ;src/main.c:16: void init_gfx(void){
                                     60 ;	---------------------------------
                                     61 ; Function init_gfx
                                     62 ; ---------------------------------
    00000000                         63 _init_gfx::
                                     64 ;src/main.c:18: set_sprite_data(0, 5, duck);
    00000000 11r00r00         [12]   65 	ld	de, #_duck
    00000003 D5               [16]   66 	push	de
    00000004 21 00 05         [12]   67 	ld	hl, #0x500
    00000007 E5               [16]   68 	push	hl
    00000008 CDr00r00         [24]   69 	call	_set_sprite_data
    0000000B E8 04            [16]   70 	add	sp, #4
                                     71 ;/home/josem/gbdk/include/gb/gb.h:1887: shadow_OAM[nb].tile=tile;
    0000000D 21r02r00         [12]   72 	ld	hl, #(_shadow_OAM + 2)
    00000010 36 00            [12]   73 	ld	(hl), #0x00
    00000012 21r06r00         [12]   74 	ld	hl, #(_shadow_OAM + 6)
    00000015 36 01            [12]   75 	ld	(hl), #0x01
    00000017 21r0Ar00         [12]   76 	ld	hl, #(_shadow_OAM + 10)
    0000001A 36 02            [12]   77 	ld	(hl), #0x02
    0000001C 21r0Er00         [12]   78 	ld	hl, #(_shadow_OAM + 14)
    0000001F 36 03            [12]   79 	ld	(hl), #0x03
    00000021 21r12r00         [12]   80 	ld	hl, #(_shadow_OAM + 18)
    00000024 36 04            [12]   81 	ld	(hl), #0x04
                                     82 ;src/main.c:25: character_init(&p,80,40);
    00000026 3E 28            [ 8]   83 	ld	a, #0x28
    00000028 F5               [16]   84 	push	af
    00000029 33               [ 8]   85 	inc	sp
    0000002A 3E 50            [ 8]   86 	ld	a, #0x50
    0000002C 11r00r00         [12]   87 	ld	de, #_p
    0000002F CDr00r00         [24]   88 	call	_character_init
                                     89 ;src/main.c:26: SHOW_SPRITES;
    00000032 F0r00            [12]   90 	ldh	a, (_LCDC_REG + 0)
    00000034 F6 02            [ 8]   91 	or	a, #0x02
    00000036 E0r00            [12]   92 	ldh	(_LCDC_REG + 0), a
                                     93 ;src/main.c:29: set_bkg_data(0, 28, map_tiles);
    00000038 11r00r00         [12]   94 	ld	de, #_map_tiles
    0000003B D5               [16]   95 	push	de
    0000003C 21 00 1C         [12]   96 	ld	hl, #0x1c00
    0000003F E5               [16]   97 	push	hl
    00000040 CDr00r00         [24]   98 	call	_set_bkg_data
    00000043 E8 04            [16]   99 	add	sp, #4
                                    100 ;src/main.c:30: set_bkg_tiles(0,0,20,18,map1);
    00000045 11r00r00         [12]  101 	ld	de, #_map1+0
    00000048 D5               [16]  102 	push	de
    00000049 D5               [16]  103 	push	de
    0000004A 21 14 12         [12]  104 	ld	hl, #0x1214
    0000004D E5               [16]  105 	push	hl
    0000004E AF               [ 4]  106 	xor	a, a
    0000004F 0F               [ 4]  107 	rrca
    00000050 F5               [16]  108 	push	af
    00000051 CDr00r00         [24]  109 	call	_set_bkg_tiles
    00000054 E8 06            [16]  110 	add	sp, #6
    00000056 D1               [12]  111 	pop	de
                                    112 ;src/main.c:31: get_colision_from_map(map1, global_colision_map);
    00000057 01r00r00         [12]  113 	ld	bc, #_global_colision_map
    0000005A CDr00r00         [24]  114 	call	_get_colision_from_map
                                    115 ;src/main.c:32: SHOW_BKG;
    0000005D F0r00            [12]  116 	ldh	a, (_LCDC_REG + 0)
    0000005F F6 01            [ 8]  117 	or	a, #0x01
    00000061 E0r00            [12]  118 	ldh	(_LCDC_REG + 0), a
                                    119 ;src/main.c:33: }
    00000063 C9               [16]  120 	ret
                                    121 ;src/main.c:35: void main(void)
                                    122 ;	---------------------------------
                                    123 ; Function main
                                    124 ; ---------------------------------
    00000064                        125 _main::
                                    126 ;src/main.c:37: init_gfx();
    00000064 CDr00r00         [24]  127 	call	_init_gfx
                                    128 ;src/main.c:39: while(1) {
    00000067                        129 00115$:
                                    130 ;src/main.c:40: switch ( global_game_state)
    00000067 FAr00r00         [16]  131 	ld	a,(#_global_game_state)
    0000006A FE 02            [ 8]  132 	cp	a,#0x02
    0000006C 28 06            [12]  133 	jr	Z, 00101$
    0000006E D6 03            [ 8]  134 	sub	a, #0x03
    00000070 28 1B            [12]  135 	jr	Z, 00106$
    00000072 18 2B            [12]  136 	jr	00110$
                                    137 ;src/main.c:42: case STATE_GAME_SETTING:
    00000074                        138 00101$:
                                    139 ;src/main.c:43: if(last_state != STATE_GAME_SETTING) {
    00000074 FAr09r00         [16]  140 	ld	a, (#_last_state)
    00000077 D6 02            [ 8]  141 	sub	a, #0x02
    00000079 28 05            [12]  142 	jr	Z, 00103$
                                    143 ;src/main.c:44: last_state = STATE_GAME_SETTING;
    0000007B 21r09r00         [12]  144 	ld	hl, #_last_state
    0000007E 36 02            [12]  145 	ld	(hl), #0x02
    00000080                        146 00103$:
                                    147 ;src/main.c:47: if(joypad() & J_START){
    00000080 CDr00r00         [24]  148 	call	_joypad
    00000083 07               [ 4]  149 	rlca
    00000084 30 19            [12]  150 	jr	NC, 00110$
                                    151 ;src/main.c:48: update_game_state(STATE_GAME_RUNNING);
    00000086 3E 03            [ 8]  152 	ld	a, #0x03
    00000088 CDr00r00         [24]  153 	call	_update_game_state
                                    154 ;src/main.c:50: break;
    0000008B 18 12            [12]  155 	jr	00110$
                                    156 ;src/main.c:52: case STATE_GAME_RUNNING:
    0000008D                        157 00106$:
                                    158 ;src/main.c:53: if(last_state != STATE_GAME_RUNNING) {
    0000008D FAr09r00         [16]  159 	ld	a, (#_last_state)
    00000090 D6 03            [ 8]  160 	sub	a, #0x03
    00000092 28 05            [12]  161 	jr	Z, 00108$
                                    162 ;src/main.c:54: last_state = STATE_GAME_RUNNING;
    00000094 21r09r00         [12]  163 	ld	hl, #_last_state
    00000097 36 03            [12]  164 	ld	(hl), #0x03
    00000099                        165 00108$:
                                    166 ;src/main.c:56: update_character(&p);
    00000099 11r00r00         [12]  167 	ld	de, #_p
    0000009C CDr00r00         [24]  168 	call	_update_character
                                    169 ;src/main.c:61: }
    0000009F                        170 00110$:
                                    171 ;src/main.c:62: performantdelay(10);
    0000009F 3E 0A            [ 8]  172 	ld	a, #0x0a
    000000A1 CDr00r00         [24]  173 	call	_performantdelay
                                    174 ;src/main.c:65: if(joypad() & J_A){
    000000A4 CDr00r00         [24]  175 	call	_joypad
    000000A7 CB 67            [ 8]  176 	bit	4, a
    000000A9 28 BC            [12]  177 	jr	Z, 00115$
                                    178 ;src/main.c:66: for(uint16_t i = 0; i<360; i++){
    000000AB 01 00 00         [12]  179 	ld	bc, #0x0000
    000000AE                        180 00118$:
    000000AE 59               [ 4]  181 	ld	e, c
    000000AF 50               [ 4]  182 	ld	d, b
    000000B0 7B               [ 4]  183 	ld	a, e
    000000B1 D6 68            [ 8]  184 	sub	a, #0x68
    000000B3 7A               [ 4]  185 	ld	a, d
    000000B4 DE 01            [ 8]  186 	sbc	a, #0x01
    000000B6 30 AF            [12]  187 	jr	NC, 00115$
                                    188 ;src/main.c:67: printf("%d",global_colision_map[i]);
    000000B8 21r00r00         [12]  189 	ld	hl, #_global_colision_map
    000000BB 09               [ 8]  190 	add	hl, bc
    000000BC 5E               [ 8]  191 	ld	e, (hl)
    000000BD AF               [ 4]  192 	xor	a, a
    000000BE C5               [16]  193 	push	bc
    000000BF 57               [ 4]  194 	ld	d, a
    000000C0 D5               [16]  195 	push	de
    000000C1 11rCEr00         [12]  196 	ld	de, #___str_0
    000000C4 D5               [16]  197 	push	de
    000000C5 CDr00r00         [24]  198 	call	_printf
    000000C8 E8 04            [16]  199 	add	sp, #4
    000000CA C1               [12]  200 	pop	bc
                                    201 ;src/main.c:66: for(uint16_t i = 0; i<360; i++){
    000000CB 03               [ 8]  202 	inc	bc
                                    203 ;src/main.c:71: }
    000000CC 18 E0            [12]  204 	jr	00118$
    000000CE                        205 ___str_0:
    000000CE 25 64                  206 	.ascii "%d"
    000000D0 00                     207 	.db 0x00
                                    208 	.area _CODE
                                    209 	.area _INITIALIZER
                                    210 	.area _CABS (ABS)
