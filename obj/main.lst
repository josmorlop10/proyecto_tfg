                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module main
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _main
                                     11 	.globl _init_gfx
                                     12 	.globl _print_objects_in_screen
                                     13 	.globl _hide_pointer
                                     14 	.globl _update_pointer
                                     15 	.globl _pointer_init
                                     16 	.globl _init_level
                                     17 	.globl _get_colision_from_map
                                     18 	.globl _update_game_state
                                     19 	.globl _update_character
                                     20 	.globl _character_init
                                     21 	.globl _performantdelay
                                     22 	.globl _printf
                                     23 	.globl _set_sprite_data
                                     24 	.globl _set_win_tiles
                                     25 	.globl _set_win_data
                                     26 	.globl _set_bkg_tiles
                                     27 	.globl _set_bkg_data
                                     28 	.globl _joypad
                                     29 	.globl _last_state
                                     30 	.globl _s
                                     31 	.globl _p
                                     32 ;--------------------------------------------------------
                                     33 ; special function registers
                                     34 ;--------------------------------------------------------
                                     35 ;--------------------------------------------------------
                                     36 ; ram data
                                     37 ;--------------------------------------------------------
                                     38 	.area _DATA
    00000000                         39 _p::
    00000000                         40 	.ds 15
    0000000F                         41 _s::
    0000000F                         42 	.ds 8
    00000017                         43 _last_state::
    00000017                         44 	.ds 1
                                     45 ;--------------------------------------------------------
                                     46 ; ram data
                                     47 ;--------------------------------------------------------
                                     48 	.area _INITIALIZED
                                     49 ;--------------------------------------------------------
                                     50 ; absolute external ram data
                                     51 ;--------------------------------------------------------
                                     52 	.area _DABS (ABS)
                                     53 ;--------------------------------------------------------
                                     54 ; global & static initialisations
                                     55 ;--------------------------------------------------------
                                     56 	.area _HOME
                                     57 	.area _GSINIT
                                     58 	.area _GSFINAL
                                     59 	.area _GSINIT
                                     60 ;--------------------------------------------------------
                                     61 ; Home
                                     62 ;--------------------------------------------------------
                                     63 	.area _HOME
                                     64 	.area _HOME
                                     65 ;--------------------------------------------------------
                                     66 ; code
                                     67 ;--------------------------------------------------------
                                     68 	.area _CODE
                                     69 ;src/main.c:25: void init_gfx(void){
                                     70 ;	---------------------------------
                                     71 ; Function init_gfx
                                     72 ; ---------------------------------
    00000000                         73 _init_gfx::
                                     74 ;src/main.c:27: set_sprite_data(0, 4, duck);
    00000000 11r00r00         [12]   75 	ld	de, #_duck
    00000003 D5               [16]   76 	push	de
    00000004 21 00 04         [12]   77 	ld	hl, #0x400
    00000007 E5               [16]   78 	push	hl
    00000008 CDr00r00         [24]   79 	call	_set_sprite_data
    0000000B E8 04            [16]   80 	add	sp, #4
                                     81 ;/home/josem/gbdk/include/gb/gb.h:1887: shadow_OAM[nb].tile=tile;
    0000000D 21r02r00         [12]   82 	ld	hl, #(_shadow_OAM + 2)
    00000010 36 00            [12]   83 	ld	(hl), #0x00
    00000012 21r06r00         [12]   84 	ld	hl, #(_shadow_OAM + 6)
    00000015 36 01            [12]   85 	ld	(hl), #0x01
    00000017 21r0Ar00         [12]   86 	ld	hl, #(_shadow_OAM + 10)
    0000001A 36 02            [12]   87 	ld	(hl), #0x02
    0000001C 21r0Er00         [12]   88 	ld	hl, #(_shadow_OAM + 14)
    0000001F 36 03            [12]   89 	ld	(hl), #0x03
                                     90 ;src/main.c:34: set_sprite_data(4, 4, selector);
    00000021 11r00r00         [12]   91 	ld	de, #_selector
    00000024 D5               [16]   92 	push	de
    00000025 21 04 04         [12]   93 	ld	hl, #0x404
    00000028 E5               [16]   94 	push	hl
    00000029 CDr00r00         [24]   95 	call	_set_sprite_data
    0000002C E8 04            [16]   96 	add	sp, #4
                                     97 ;/home/josem/gbdk/include/gb/gb.h:1887: shadow_OAM[nb].tile=tile;
    0000002E 21r12r00         [12]   98 	ld	hl, #(_shadow_OAM + 18)
    00000031 36 04            [12]   99 	ld	(hl), #0x04
    00000033 21r16r00         [12]  100 	ld	hl, #(_shadow_OAM + 22)
    00000036 36 05            [12]  101 	ld	(hl), #0x05
    00000038 21r1Ar00         [12]  102 	ld	hl, #(_shadow_OAM + 26)
    0000003B 36 06            [12]  103 	ld	(hl), #0x06
    0000003D 21r1Er00         [12]  104 	ld	hl, #(_shadow_OAM + 30)
    00000040 36 07            [12]  105 	ld	(hl), #0x07
                                    106 ;src/main.c:41: set_sprite_data(8,8,object_sprites);
    00000042 11r00r00         [12]  107 	ld	de, #_object_sprites
    00000045 D5               [16]  108 	push	de
    00000046 21 08 08         [12]  109 	ld	hl, #0x808
    00000049 E5               [16]  110 	push	hl
    0000004A CDr00r00         [24]  111 	call	_set_sprite_data
    0000004D E8 04            [16]  112 	add	sp, #4
                                    113 ;/home/josem/gbdk/include/gb/gb.h:1887: shadow_OAM[nb].tile=tile;
    0000004F 21r22r00         [12]  114 	ld	hl, #(_shadow_OAM + 34)
    00000052 36 08            [12]  115 	ld	(hl), #0x08
    00000054 21r26r00         [12]  116 	ld	hl, #(_shadow_OAM + 38)
    00000057 36 09            [12]  117 	ld	(hl), #0x09
    00000059 21r2Ar00         [12]  118 	ld	hl, #(_shadow_OAM + 42)
    0000005C 36 0A            [12]  119 	ld	(hl), #0x0a
    0000005E 21r2Er00         [12]  120 	ld	hl, #(_shadow_OAM + 46)
    00000061 36 0B            [12]  121 	ld	(hl), #0x0b
    00000063 21r32r00         [12]  122 	ld	hl, #(_shadow_OAM + 50)
    00000066 36 0C            [12]  123 	ld	(hl), #0x0c
    00000068 21r36r00         [12]  124 	ld	hl, #(_shadow_OAM + 54)
    0000006B 36 0D            [12]  125 	ld	(hl), #0x0d
    0000006D 21r3Ar00         [12]  126 	ld	hl, #(_shadow_OAM + 58)
    00000070 36 0E            [12]  127 	ld	(hl), #0x0e
    00000072 21r3Er00         [12]  128 	ld	hl, #(_shadow_OAM + 62)
    00000075 36 0F            [12]  129 	ld	(hl), #0x0f
                                    130 ;src/main.c:50: SHOW_SPRITES;
    00000077 F0r00            [12]  131 	ldh	a, (_LCDC_REG + 0)
    00000079 F6 02            [ 8]  132 	or	a, #0x02
    0000007B E0r00            [12]  133 	ldh	(_LCDC_REG + 0), a
                                    134 ;src/main.c:53: set_bkg_data(0, 104, map_tiles_alt);
    0000007D 11r00r00         [12]  135 	ld	de, #_map_tiles_alt
    00000080 D5               [16]  136 	push	de
    00000081 21 00 68         [12]  137 	ld	hl, #0x6800
    00000084 E5               [16]  138 	push	hl
    00000085 CDr00r00         [24]  139 	call	_set_bkg_data
    00000088 E8 04            [16]  140 	add	sp, #4
                                    141 ;src/main.c:54: set_bkg_tiles(0,0,20,16,map1_alt);
    0000008A 11r00r00         [12]  142 	ld	de, #_map1_alt
    0000008D D5               [16]  143 	push	de
    0000008E 21 14 10         [12]  144 	ld	hl, #0x1014
    00000091 E5               [16]  145 	push	hl
    00000092 AF               [ 4]  146 	xor	a, a
    00000093 0F               [ 4]  147 	rrca
    00000094 F5               [16]  148 	push	af
    00000095 CDr00r00         [24]  149 	call	_set_bkg_tiles
    00000098 E8 06            [16]  150 	add	sp, #6
                                    151 ;src/main.c:55: SHOW_BKG;
    0000009A F0r00            [12]  152 	ldh	a, (_LCDC_REG + 0)
    0000009C F6 01            [ 8]  153 	or	a, #0x01
    0000009E E0r00            [12]  154 	ldh	(_LCDC_REG + 0), a
                                    155 ;src/main.c:59: set_win_data(104,26, hud_tiles);
    000000A0 11r00r00         [12]  156 	ld	de, #_hud_tiles
    000000A3 D5               [16]  157 	push	de
    000000A4 21 68 1A         [12]  158 	ld	hl, #0x1a68
    000000A7 E5               [16]  159 	push	hl
    000000A8 CDr00r00         [24]  160 	call	_set_win_data
    000000AB E8 04            [16]  161 	add	sp, #4
                                    162 ;src/main.c:60: set_win_tiles(0,0,20,3, hud_selector);
    000000AD 11r00r00         [12]  163 	ld	de, #_hud_selector
    000000B0 D5               [16]  164 	push	de
    000000B1 21 14 03         [12]  165 	ld	hl, #0x314
    000000B4 E5               [16]  166 	push	hl
    000000B5 AF               [ 4]  167 	xor	a, a
    000000B6 0F               [ 4]  168 	rrca
    000000B7 F5               [16]  169 	push	af
    000000B8 CDr00r00         [24]  170 	call	_set_win_tiles
    000000BB E8 06            [16]  171 	add	sp, #6
                                    172 ;src/main.c:61: SHOW_WIN;
    000000BD F0r00            [12]  173 	ldh	a, (_LCDC_REG + 0)
    000000BF F6 20            [ 8]  174 	or	a, #0x20
    000000C1 E0r00            [12]  175 	ldh	(_LCDC_REG + 0), a
                                    176 ;src/main.c:62: WX_REG = 7;      // SIEMPRE 7
    000000C3 3E 07            [ 8]  177 	ld	a, #0x07
    000000C5 E0r00            [12]  178 	ldh	(_WX_REG + 0), a
                                    179 ;src/main.c:63: WY_REG = 120;    // 144 - 24
    000000C7 3E 78            [ 8]  180 	ld	a, #0x78
    000000C9 E0r00            [12]  181 	ldh	(_WY_REG + 0), a
                                    182 ;src/main.c:64: }
    000000CB C9               [16]  183 	ret
                                    184 ;src/main.c:66: void main(void)
                                    185 ;	---------------------------------
                                    186 ; Function main
                                    187 ; ---------------------------------
    000000CC                        188 _main::
                                    189 ;src/main.c:68: init_gfx();
    000000CC CDr00r00         [24]  190 	call	_init_gfx
                                    191 ;src/main.c:69: pointer_init(&s);
    000000CF 11r0Fr00         [12]  192 	ld	de, #_s
    000000D2 CDr00r00         [24]  193 	call	_pointer_init
                                    194 ;src/main.c:71: global_game_state = STATE_GAME_SETTING;
    000000D5 21r00r00         [12]  195 	ld	hl, #_global_game_state
    000000D8 36 02            [12]  196 	ld	(hl), #0x02
                                    197 ;src/main.c:73: while(1) {
    000000DA                        198 00120$:
                                    199 ;src/main.c:74: switch (global_game_state)
    000000DA FAr00r00         [16]  200 	ld	a, (#_global_game_state)
    000000DD D6 02            [ 8]  201 	sub	a, #0x02
    000000DF 28 12            [12]  202 	jr	Z, 00101$
    000000E1 FAr00r00         [16]  203 	ld	a, (#_global_game_state)
    000000E4 D6 03            [ 8]  204 	sub	a, #0x03
    000000E6 28 40            [12]  205 	jr	Z, 00106$
    000000E8 FAr00r00         [16]  206 	ld	a, (#_global_game_state)
    000000EB D6 05            [ 8]  207 	sub	a, #0x05
    000000ED CAr70r01         [16]  208 	jp	Z, 00112$
    000000F0 C3r8Fr01         [16]  209 	jp	00118$
                                    210 ;src/main.c:76: case STATE_GAME_SETTING:
    000000F3                        211 00101$:
                                    212 ;src/main.c:77: if(last_state != STATE_GAME_SETTING) {
    000000F3 FAr17r00         [16]  213 	ld	a, (#_last_state)
    000000F6 D6 02            [ 8]  214 	sub	a, #0x02
    000000F8 28 18            [12]  215 	jr	Z, 00103$
                                    216 ;src/main.c:78: init_gfx();
    000000FA CDr00r00         [24]  217 	call	_init_gfx
                                    218 ;src/main.c:79: init_level(0);
    000000FD AF               [ 4]  219 	xor	a, a
    000000FE CDr00r00         [24]  220 	call	_init_level
                                    221 ;src/main.c:80: get_colision_from_map(map1_alt, global_colision_map);
    00000101 01r00r00         [12]  222 	ld	bc, #_global_colision_map
    00000104 11r00r00         [12]  223 	ld	de, #_map1_alt
    00000107 CDr00r00         [24]  224 	call	_get_colision_from_map
                                    225 ;src/main.c:82: print_objects_in_screen();
    0000010A CDr00r00         [24]  226 	call	_print_objects_in_screen
                                    227 ;src/main.c:83: last_state = STATE_GAME_SETTING;
    0000010D 21r17r00         [12]  228 	ld	hl, #_last_state
    00000110 36 02            [12]  229 	ld	(hl), #0x02
    00000112                        230 00103$:
                                    231 ;src/main.c:85: update_pointer(&s);
    00000112 11r0Fr00         [12]  232 	ld	de, #_s
    00000115 CDr00r00         [24]  233 	call	_update_pointer
                                    234 ;src/main.c:86: if(joypad() & J_START){
    00000118 CDr00r00         [24]  235 	call	_joypad
    0000011B 07               [ 4]  236 	rlca
    0000011C 30 71            [12]  237 	jr	NC, 00118$
                                    238 ;src/main.c:87: hide_pointer();
    0000011E CDr00r00         [24]  239 	call	_hide_pointer
                                    240 ;src/main.c:88: update_game_state(STATE_GAME_RUNNING);
    00000121 3E 03            [ 8]  241 	ld	a, #0x03
    00000123 CDr00r00         [24]  242 	call	_update_game_state
                                    243 ;src/main.c:90: break;
    00000126 18 67            [12]  244 	jr	00118$
                                    245 ;src/main.c:92: case STATE_GAME_RUNNING:
    00000128                        246 00106$:
                                    247 ;src/main.c:93: if(last_state != STATE_GAME_RUNNING) {
    00000128 FAr17r00         [16]  248 	ld	a, (#_last_state)
    0000012B D6 03            [ 8]  249 	sub	a, #0x03
    0000012D 28 0B            [12]  250 	jr	Z, 00108$
                                    251 ;src/main.c:94: character_init(&p);
    0000012F 11r00r00         [12]  252 	ld	de, #_p
    00000132 CDr00r00         [24]  253 	call	_character_init
                                    254 ;src/main.c:95: last_state = STATE_GAME_RUNNING;
    00000135 21r17r00         [12]  255 	ld	hl, #_last_state
    00000138 36 03            [12]  256 	ld	(hl), #0x03
    0000013A                        257 00108$:
                                    258 ;src/main.c:97: update_character(&p);
    0000013A 11r00r00         [12]  259 	ld	de, #_p
    0000013D CDr00r00         [24]  260 	call	_update_character
                                    261 ;src/main.c:100: if(joypad() & J_A){
    00000140 CDr00r00         [24]  262 	call	_joypad
    00000143 CB 67            [ 8]  263 	bit	4, a
    00000145 28 48            [12]  264 	jr	Z, 00118$
                                    265 ;src/main.c:101: HIDE_WIN;
    00000147 F0r00            [12]  266 	ldh	a, (_LCDC_REG + 0)
    00000149 E6 DF            [ 8]  267 	and	a, #0xdf
    0000014B E0r00            [12]  268 	ldh	(_LCDC_REG + 0), a
                                    269 ;src/main.c:102: for(uint16_t i = 0; i<NUMBER_OF_TILES_IN_GRID; i++){
    0000014D 01 00 00         [12]  270 	ld	bc, #0x0000
    00000150                        271 00123$:
    00000150 59               [ 4]  272 	ld	e, c
    00000151 50               [ 4]  273 	ld	d, b
    00000152 7B               [ 4]  274 	ld	a, e
    00000153 D6 2C            [ 8]  275 	sub	a, #0x2c
    00000155 7A               [ 4]  276 	ld	a, d
    00000156 DE 01            [ 8]  277 	sbc	a, #0x01
    00000158 30 35            [12]  278 	jr	NC, 00118$
                                    279 ;src/main.c:103: printf("%d",global_colision_map[i]);
    0000015A 21r00r00         [12]  280 	ld	hl, #_global_colision_map
    0000015D 09               [ 8]  281 	add	hl, bc
    0000015E 5E               [ 8]  282 	ld	e, (hl)
    0000015F 16 00            [ 8]  283 	ld	d, #0x00
    00000161 21r97r01         [12]  284 	ld	hl, #___str_0
    00000164 C5               [16]  285 	push	bc
    00000165 D5               [16]  286 	push	de
    00000166 E5               [16]  287 	push	hl
    00000167 CDr00r00         [24]  288 	call	_printf
    0000016A E8 04            [16]  289 	add	sp, #4
    0000016C C1               [12]  290 	pop	bc
                                    291 ;src/main.c:102: for(uint16_t i = 0; i<NUMBER_OF_TILES_IN_GRID; i++){
    0000016D 03               [ 8]  292 	inc	bc
    0000016E 18 E0            [12]  293 	jr	00123$
                                    294 ;src/main.c:110: case STATE_GAME_OVER:
    00000170                        295 00112$:
                                    296 ;src/main.c:111: if(last_state != STATE_GAME_OVER) {
    00000170 FAr17r00         [16]  297 	ld	a, (#_last_state)
    00000173 D6 05            [ 8]  298 	sub	a, #0x05
    00000175 28 0D            [12]  299 	jr	Z, 00114$
                                    300 ;src/main.c:112: last_state = STATE_GAME_OVER;
    00000177 21r17r00         [12]  301 	ld	hl, #_last_state
    0000017A 36 05            [12]  302 	ld	(hl), #0x05
                                    303 ;src/main.c:113: printf("You WIN!\nPress start to try again");
    0000017C 11r9Ar01         [12]  304 	ld	de, #___str_1
    0000017F D5               [16]  305 	push	de
    00000180 CDr00r00         [24]  306 	call	_printf
    00000183 E1               [12]  307 	pop	hl
    00000184                        308 00114$:
                                    309 ;src/main.c:115: if(joypad() & J_START){
    00000184 CDr00r00         [24]  310 	call	_joypad
    00000187 07               [ 4]  311 	rlca
    00000188 30 05            [12]  312 	jr	NC, 00118$
                                    313 ;src/main.c:116: update_game_state(STATE_GAME_SETTING);
    0000018A 3E 02            [ 8]  314 	ld	a, #0x02
    0000018C CDr00r00         [24]  315 	call	_update_game_state
                                    316 ;src/main.c:122: }
    0000018F                        317 00118$:
                                    318 ;src/main.c:123: performantdelay(10);
    0000018F 3E 0A            [ 8]  319 	ld	a, #0x0a
    00000191 CDr00r00         [24]  320 	call	_performantdelay
                                    321 ;src/main.c:125: }
    00000194 C3rDAr00         [16]  322 	jp	00120$
    00000197                        323 ___str_0:
    00000197 25 64                  324 	.ascii "%d"
    00000199 00                     325 	.db 0x00
    0000019A                        326 ___str_1:
    0000019A 59 6F 75 20 57 49 4E   327 	.ascii "You WIN!"
             21
    000001A2 0A                     328 	.db 0x0a
    000001A3 50 72 65 73 73 20 73   329 	.ascii "Press start to try again"
             74 61 72 74 20 74 6F
             20 74 72 79 20 61 67
             61 69 6E
    000001BB 00                     330 	.db 0x00
                                    331 	.area _CODE
                                    332 	.area _INITIALIZER
                                    333 	.area _CABS (ABS)
